# 要件定義 - クラウドサービス

## システム価値

### システムコンテキスト

```plantuml
@startuml

title システムコンテキスト図 - クラウドサービス

left to right direction

actor 顧客 as ac_01
actor 会員 as ac_02
actor 個人会員 as ac_03
actor 法人会員 as ac_04
actor 法人会員管理者 as ac_05
ac_01 <|-- ac_02
ac_02 <|-- ac_03
ac_02 <|-- ac_04
ac_04 <|-- ac_05

actor スタッフ as staff_group
actor 顧客サポート as ac_06
actor サービス企画 as ac_07
actor マーケター as ac_08
actor インサイドセールス as ac_09
actor カスタマーサクセス as ac_10
actor 法人営業 as ac_11
actor 代理店担当者 as ac_12
actor 経理担当者 as ac_13
staff_group <|-- ac_06
staff_group <|-- ac_07
staff_group <|-- ac_08
staff_group <|-- ac_09
staff_group <|-- ac_10
staff_group <|-- ac_11
staff_group <|-- ac_12
staff_group <|-- ac_13

agent 債権管理システム
agent 決済機関
agent BIツール
agent ポイントシステム
agent コンテンツシステム
agent マーケティングオートメーション
agent メッセージ管理システム
agent 自社サービス

usecase クラウドサービス as uc_01
note top of uc_01
  クラウドサービスの総合プラットフォーム。
  サービス管理、会員管理、販売促進、代理店管理、
  精算業務、サポート業務を統合管理し、
  効率的なクラウドビジネス運営を実現する。
end note

ac_02 -- (uc_01)
ac_03 -- (uc_01)  
ac_04 -- (uc_01)
ac_05 -- (uc_01)
staff_group -- (uc_01)

(uc_01) -- 債権管理システム
(uc_01) -- 決済機関
(uc_01) -- BIツール
(uc_01) -- ポイントシステム
(uc_01) -- コンテンツシステム
(uc_01) -- マーケティングオートメーション
(uc_01) -- メッセージ管理システム
(uc_01) -- 自社サービス

@enduml
```

### 要求モデル

```plantuml
@startuml

title 要求モデル図 - クラウドサービス

left to right direction

actor 会員 as ac_01
note "サービスを簡単に申込み利用したい" as k_r1
note "ポイントやクーポンで割引を受けたい" as k_r2
note "個人情報の確認・変更をしたい" as k_r3
note "サポートに問い合わせをしたい" as k_r4
note as k_dr1 #Turquoise
  Webで簡単にサービス申込ができ、
  ポイント・クーポン機能があり、
  個人情報管理とサポート機能が充実していること
end note
ac_01 -- k_r1
ac_01 -- k_r2
ac_01 -- k_r3
ac_01 -- k_r4
k_r1 -- k_dr1
k_r2 -- k_dr1
k_r3 -- k_dr1
k_r4 -- k_dr1

actor サービス企画 as ac_02
note "新サービスの企画・登録・管理をしたい" as s_r1
note "サービス改善レポートを管理したい" as s_r2
note "販売プランの作成と効果測定をしたい" as s_r3
note as s_dr1 #Turquoise
  サービスライフサイクル全体を
  効率的に管理できること
end note
ac_02 -- s_r1
ac_02 -- s_r2
ac_02 -- s_r3
s_r1 -- s_dr1
s_r2 -- s_dr1
s_r3 -- s_dr1

actor マーケター as ac_03
note "コンテンツ管理と販売促進活動をしたい" as m_r1
note "効果測定と分析をしたい" as m_r2
note "パイプライン設計をしたい" as m_r3
note as m_dr1 #Turquoise
  マーケティング活動を統合的に
  管理・分析できること
end note
ac_03 -- m_r1
ac_03 -- m_r2
ac_03 -- m_r3
m_r1 -- m_dr1
m_r2 -- m_dr1
m_r3 -- m_dr1

actor 法人営業 as ac_04
note "リード管理とコンタクト記録をしたい" as h_r1
note "法人向け提案とサービス追加をしたい" as h_r2
note "代理店管理をしたい" as h_r3
note as h_dr1 #Turquoise
  法人営業活動を効率的に
  管理できること
end note
ac_04 -- h_r1
ac_04 -- h_r2
ac_04 -- h_r3
h_r1 -- h_dr1
h_r2 -- h_dr1
h_r3 -- h_dr1

@enduml
```

## システム外部環境

### ビジネスコンテキスト

```plantuml
@startuml

title ビジネスコンテキスト図 - クラウドサービス

left to right direction

actor 顧客 as ac_01
actor 会員 as ac_02

node クラウドサービス事業会社 {
  rectangle 営業部門 {
    actor マーケター as ac_03
    actor インサイドセールス as ac_04
    actor 法人営業 as ac_05
    actor カスタマーサクセス as ac_06
    actor 代理店担当者 as ac_07
  }
  
  rectangle サービス部門 {
    actor サービス企画 as ac_08
  }
  
  rectangle サポート部門 {
    actor 顧客サポート as ac_09
  }
  
  rectangle 経理部門 {
    actor 経理担当者 as ac_10
  }
  
  usecase サービス管理業務 as uc_01
  usecase マーケティング業務 as uc_02
  usecase サービス申込業務 as uc_03
  usecase 会員活動管理業務 as uc_04
  usecase 精算業務 as uc_05
  usecase サポート業務 as uc_06
  usecase カスタマーサクセス業務 as uc_07
  usecase 代理店管理業務 as uc_08
}

node 外部連携システム {
  agent 決済機関 as ext_01
  agent BIツール as ext_02
  agent コンテンツシステム as ext_03
  agent マーケティングオートメーション as ext_04
  agent 債権管理システム as ext_05
  agent ポイントシステム as ext_06
  agent 自社サービス as ext_07
}

ac_01 -- (uc_03)
ac_02 -- (uc_03)
ac_02 -- (uc_04)

(uc_01) -- ac_08
(uc_02) -- ac_03
(uc_02) -- ac_04
(uc_03) -- ac_05
(uc_04) -- ac_06
(uc_05) -- ac_10
(uc_06) -- ac_09
(uc_07) -- ac_06
(uc_08) -- ac_05
(uc_08) -- ac_07

(uc_03) -- ext_01
(uc_02) -- ext_02
(uc_02) -- ext_03
(uc_02) -- ext_04
(uc_05) -- ext_05
(uc_04) -- ext_06
(uc_01) -- ext_07

@enduml
```

### ビジネスユースケース

#### サービス管理業務

```plantuml
@startuml

title ビジネスユースケース図 - サービス管理業務

left to right direction

actor サービス企画 as ac_01
actor 顧客サポート as ac_02
actor カスタマーサクセス as ac_03

agent サービス部門 as ag_01

usecase サービス登録フロー as uc_01
usecase サービス管理フロー as uc_02  
usecase サービス分析フロー as uc_03

artifact サービス仕様 as af_01
artifact 販売プラン as af_02
artifact 改善レポート as af_03

ac_01 -- (uc_01)
ac_01 -- (uc_02)
ac_02 -- (uc_03)
ac_03 -- (uc_03)

(uc_01) -- ag_01
(uc_02) -- ag_01
(uc_03) -- ag_01

(uc_01) -- af_01
(uc_01) -- af_02
(uc_02) -- af_01
(uc_03) -- af_03

@enduml
```

#### マーケティング業務

```plantuml
@startuml

title ビジネスユースケース図 - マーケティング業務

left to right direction

actor マーケター as ac_01
actor インサイドセールス as ac_02
actor カスタマーサクセス as ac_03

agent 営業部門 as ag_01

usecase コンテンツ管理フロー as uc_01
usecase 販売促進活動フロー as uc_02
usecase 顧客インサイト検討フロー as uc_03

artifact コンテンツ情報 as af_01
artifact 販売促進仕様 as af_02
artifact 効果測定結果 as af_03

ac_01 -- (uc_01)
ac_01 -- (uc_02)
ac_02 -- (uc_01)
ac_02 -- (uc_02)
ac_03 -- (uc_01)

(uc_01) -- ag_01
(uc_02) -- ag_01
(uc_03) -- ag_01

(uc_01) -- af_01
(uc_02) -- af_02
(uc_03) -- af_03

@enduml
```

### バリエーション・条件

#### 会員区分

| 会員種別 | 説明 |
|----------|------|
| 個人会員 | 個人でサービスを利用する会員 |
| 法人会員管理者 | 法人会員の管理者権限を持つ会員 |
| 法人会員 | 法人会員の一般利用者 |

#### サービス分類

| サービス種別 | 説明 |
|-------------|------|
| サービス提供 | 直接的なサービスの提供 |
| プラットフォーム | サービス提供の基盤となるプラットフォーム |

#### 申込経路

| 申込経路種別 | 説明 |
|-------------|------|
| 直販 | 自社直接販売 |
| 代理店 | 代理店経由での販売 |

## システム境界

### ユースケース複合図

#### サービス申込業務

```plantuml
@startuml

title ユースケース複合図 - サービス申込業務

left to right direction

actor 会員 as user
actor 法人営業 as admin

frame "個人向け新規サービス申込フロー" as f01
usecase "会員とサービス申込を登録する" as UC1
usecase "決済口座を確認する" as UC2
boundary "会員登録画面" as b01
boundary "サービス申込画面" as b02  
boundary "決済口座設定画面" as b03
entity "会員情報" as e01
entity "サービス申込情報" as e02
entity "個人情報" as e03
entity "アカウント情報" as e04
control "会員登録条件" as c01

user -- f01
f01 -- UC1
f01 -- UC2

b01 -- UC1
b02 -- UC1
UC1 -- e01
UC1 -- e02
UC1 -- e03
UC1 -- e04
UC1 -- c01

b03 -- UC2
UC2 -- e01

frame "法人向けサービス追加フロー" as f02
usecase "サービス利用を追加申込する" as UC3
boundary "サービス申込画面" as b04
entity "サービス申込情報" as e05

admin -- f02
f02 -- UC3
b04 -- UC3
UC3 -- e05

@enduml
```

#### 精算業務

```plantuml
@startuml

title ユースケース複合図 - 精算業務

left to right direction

actor 経理担当者 as admin

frame "個人精算フロー" as f01
usecase "サービス利用料を計算する" as UC1
usecase "課金額に応じたポイントを付与する" as UC2
usecase "精算の調整を行う" as UC3

boundary "精算調整画面" as b01
entity "会員サービス契約情報" as e01
entity "月別個人課金情報" as e02
entity "割引情報" as e03
control "クーポン割引条件" as c01
control "手数料料率" as c02

f01 -- UC1
f01 -- UC2  
f01 -- UC3

UC1 -- e01
UC1 -- e02
UC1 -- c01
UC1 -- c02

UC2 -- e01
UC2 -- e03

admin -- f01
b01 -- UC3
UC3 -- e02

@enduml
```

## システム

### 情報モデル

```plantuml
@startuml

title 情報モデル図 - クラウドサービス

left to right direction

' 会員関連
entity 会員情報
entity 個人情報  
entity 法人情報
entity アカウント情報

' サービス関連
entity サービス仕様
entity オプション仕様
entity 販売プラン情報
entity 会員サービス契約情報
entity サービス申込情報
entity サービス利用実績

' 精算関連
entity 月別個人課金情報
entity 月別法人課金情報  
entity 割引情報

' マーケティング関連
entity コンテンツ情報
entity コンテンツ利用記録
entity 販売促進仕様
entity 販売促進記録
entity リード情報
entity コンタクト記録

' 代理店関連
entity 代理店情報
entity 代理店契約情報
entity 代理店精算実績

' サポート関連
entity サポート記録
entity 問合せ記録

' 関連付け
会員情報 -- 個人情報
会員情報 -- 法人情報
会員情報 -- アカウント情報
会員情報 -- 会員サービス契約情報
会員情報 -- 月別個人課金情報
会員情報 -- コンタクト記録
会員情報 -- サポート記録

サービス仕様 -- オプション仕様
サービス仕様 -- 販売プラン情報
販売プラン情報 -- サービス申込情報
会員サービス契約情報 -- サービス利用実績
会員サービス契約情報 -- サービス申込情報

月別個人課金情報 -- 割引情報
月別法人課金情報 -- 法人情報
月別法人課金情報 -- 割引情報

コンテンツ情報 -- コンテンツ利用記録
コンテンツ利用記録 -- 会員情報
販売促進仕様 -- 販売促進記録
リード情報 -- コンタクト記録

代理店情報 -- 代理店契約情報
代理店情報 -- 代理店精算実績
代理店情報 -- サービス申込情報

サポート記録 -- 問合せ記録
サポート記録 -- 会員情報

@enduml
```

### 状態モデル

#### 会員状態の遷移

```plantuml
@startuml

title 会員状態の遷移図

[*] --> 顧客

顧客 --> 利用中 : 会員とサービス申込を登録する

state 利用中 {
  [*] --> サービス利用中
  サービス利用中 --> 休会中 : 休会を登録する
  休会中 --> サービス利用中 : 休会を登録する（復活）
}

利用中 --> 退会 : 退会を申請する
退会 --> [*]

note right of 顧客
  サービス利用前の状態
  - 問い合わせ可能
  - 申込検討中
end note

note right of 利用中
  会員として登録済み
  - サービス利用可能
  - 追加申込可能
  - 休会申請可能
end note

note right of 退会
  退会手続き完了状態
  - サービス利用不可
  - 履歴データは保持
end note

@enduml
```

#### サービス状態の遷移

```plantuml
@startuml

title サービス状態の遷移図

[*] --> サービス開発中 : サービス仕様を登録する

サービス開発中 --> サービス公開中 : サービスを公開する
サービス公開中 --> サービス停止中 : サービスの状態を変える（メンテナンス）
サービス停止中 --> サービス公開中 : サービスの状態を変える（メンテナンス完了）
サービス公開中 --> サービス終了 : サービスの状態を変える（終了）
サービス終了 --> [*]

note right of サービス開発中
  サービス開発・準備段階
  - 仕様策定中
  - テスト実施中
  - 公開準備中
end note

note right of サービス公開中
  サービス提供中の状態
  - 申込受付可能
  - サービス利用可能
  - 通常運用中
end note

note right of サービス停止中
  一時的な停止状態
  - メンテナンス中
  - 障害対応中
  - 新規申込停止
end note

@enduml
```

#### 精算状態の遷移

```plantuml
@startuml

title 精算状態の遷移図

[*] --> 精算前

精算前 --> 計算済み : サービス利用料を計算する
計算済み --> 請求済み : 債権情報を連携する
請求済み --> 回収済み : 請求回収情報を連携する（正常回収）
請求済み --> 課金未支払い : 請求回収情報を連携する（未収）
課金未支払い --> 回収済み : 請求回収情報を連携する（後日回収）

回収済み --> [*]

note right of 精算前
  サービス利用後の状態
  - 利用実績確定
  - 課金計算待ち
end note

note right of 計算済み
  課金額確定状態
  - 割引適用済み
  - ポイント計算済み
  - 請求処理待ち
end note

note right of 請求済み
  請求処理完了状態
  - 請求書発行済み
  - 決済処理待ち
end note

note right of 課金未支払い
  未収金発生状態
  - 決済エラー
  - 督促対象
  - 再請求必要
end note

@enduml
```