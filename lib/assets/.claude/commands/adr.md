## ADR (Architecture Decision Record)

アーキテクチャ決定記録（ADR）の作成・管理を行うコマンド。

### 使い方

```bash
/adr [オプション] [引数]
```

### オプション

- なし : ADR 一覧を表示
- `--create <タイトル>` : 新しい ADR を作成
- `--update <番号>` : 既存の ADR を更新
- `--status <番号> <ステータス>` : ADR のステータスを更新
- `<番号>` : 指定した ADR の内容を表示

### 基本例

```bash
# ADR 一覧を表示
/adr
「現在のADR一覧を表示してください」

# 新しい ADR を作成
/adr --create バックエンドキャッシュ戦略の選択
「Redis をキャッシュとして採用する ADR を作成してください」

# 特定の ADR を表示
/adr 005
「ADR-005 の内容を表示してください」

# ADR のステータスを更新
/adr --status 003 deprecated
「ADR-003 を deprecated に変更してください」
```

### 詳細機能

#### ADR ファイル構造

ADR は `docs/adr/` ディレクトリに以下の命名規則で保存される:

```
docs/adr/
├── 001-backend-architecture-pattern.md
├── 002-backend-framework.md
├── 003-frontend-framework.md
└── 004-database.md
```

#### ADR テンプレート

新しい ADR は以下のテンプレートで作成する:

```markdown
# ADR-NNN: タイトル

簡潔な説明（1行で決定内容を要約）。

日付: YYYY-MM-DD

## ステータス

提案中 | 承認済み | 廃止 | 置換（ADR-XXX で置換）

## コンテキスト

この決定が必要になった背景・状況を説明。

- 現在の課題や制約
- 関連するシステムやサービス
- ビジネス要件

## 決定

**何を決定したか** を明確に記述。

### 変更箇所

具体的な実装変更がある場合は記載:

1. **ファイル1**
   ```
   変更内容
   ```

2. **ファイル2**
   ```
   変更内容
   ```

### 代替案

検討した代替案とその却下理由:

1. **代替案1**
   - 却下理由: ...

2. **代替案2**
   - 却下理由: ...

## 影響

### ポジティブ

- 良い影響1
- 良い影響2

### ネガティブ

- 悪い影響や注意点1
- 悪い影響や注意点2

## コンプライアンス

決定が正しく実装されていることを確認する方法:

- チェック項目1
- チェック項目2

## 備考

- 著者: 担当者名
- 関連コミット: コミットハッシュ
- 関連 ADR: ADR-XXX
```

#### ステータスの種類

| ステータス | 説明 |
|-----------|------|
| 提案中 | レビュー待ちの ADR |
| 承認済み | 採用された決定 |
| 廃止 | 無効になった決定 |
| 置換 | 別の ADR で置き換えられた |

### Claude との連携

```bash
# 既存の設計からADRを抽出
cat docs/design/architecture.md
/adr --create
「アーキテクチャ設計から主要な決定をADRとして抽出してください」

# 問題の背景を説明してADR作成
「NAS環境でWikiサービスがポート3000を使用しているため、
バックエンドのポートを3001に変更したい」
/adr --create バックエンドAPIポート変更

# ADR作成後の関連ドキュメント更新
/adr --create 新機能の技術選定
「ADR作成後、docs/index.md と mkdocs.yml も更新してください」
```

### 注意事項

- **採番規則**: ADR 番号は 001 から連番で管理。既存の最大番号 + 1 で採番
- **ファイル名**: `NNN-kebab-case-title.md` 形式（例: `006-cache-strategy.md`）
- **配置場所**: 必ず `docs/adr/` ディレクトリに配置
- **ドキュメント更新**: 新規 ADR 作成時は `docs/index.md` と `mkdocs.yml` も更新が必要
- **コミット禁止**: ユーザーの指示があるまでコミットしない

### ベストプラクティス

1. **簡潔な要約**: タイトル直下に 1 行で決定内容を要約する
2. **コンテキストの明確化**: なぜこの決定が必要なのか背景を説明
3. **代替案の記録**: 検討した選択肢と却下理由を残す
4. **影響の両面記載**: ポジティブ・ネガティブ両方の影響を記載
5. **コンプライアンス項目**: 決定が守られていることを確認する方法を記載

### 関連コマンド

- `/docs` : ドキュメントの更新・管理
- `/analysis-architecture` : アーキテクチャ分析
- `/git-commit` : 変更のコミット
